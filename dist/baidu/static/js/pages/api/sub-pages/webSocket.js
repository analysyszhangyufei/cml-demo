var __CML__GLOBAL=require("../../../manifest.js");__CML__GLOBAL.webpackJsonp([13],{186:function(t,e,s){s(187),s(188)},187:function(t,e){},188:function(t,e,s){function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=s(189),a=n(i),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=s(0),c=n(u);e.default={data:{title:"cml.initSocket",subtitle:"演示 websocket 链接，发送，接收和关闭",respones:[],isShowLoading:!1,msgs:{},ws:null,cell:{title:"WebSocket 演示",list:[{title:"初始化一个 socket 链接",btnText:"点击开启",extraData:{action:"open"}},{title:"发送数据",btnText:"点击发送",extraData:{action:"send"}},{title:"关闭 socket 链接",btnText:"点击关闭",extraData:{action:"close"}}]}},methods:{onBtnClicked:function(t){var e=t.detail.extraData.action;this[void 0===e?"open":e]()},showLoading:function(){this.isShowLoading=!0},hideLoading:function(){this.isShowLoading=!1},flushMsg:function(){this.msgs={},this.flatten2Responses()},flatten2Responses:function(){this.respones=Object.entries(this.msgs).map(function(t){return{name:t[0],value:"string"==typeof t[1]&&t[1],child:"object"===r(t[1])&&t[1]}})},appendMsg:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t in this.msgs)if("string"==typeof this.msgs[t]&&(this.msgs[t]=[this.msgs[t]]),"string"==typeof e)this.msgs[t].push(e);else{var s;(s=this.msgs[t]).push.apply(s,o(e))}else this.msgs[t]=e;this.flatten2Responses()},open:function(){var t=this,e=this.ws=(0,a.default)("ws://echo.websocket.org");this.showLoading(),this.flushMsg(),this.appendMsg("建立链接","ws://echo.websocket.org"),e.onopen(function(){t.hideLoading(),t.appendMsg("建立链接","链接成功")}),e.onmessage(function(e){t.hideLoading(),t.appendMsg("接收透传信息",e.data)}),e.onerror(function(e){t.hideLoading(),t.appendMsg("链接错误",e.message)}),e.onclose(function(){t.hideLoading(),t.appendMsg("链接关闭","关闭成功"),t.ws=null})},send:function(){if(!this.ws)return this.appendMsg("错误提示","请先开启 socket 链接");this.showLoading(),this.appendMsg("发送信息",["一段文本信息: Hi, this is cml","一个数组: 1,2,3"]),this.ws.send({text:"Hi, this is cml",arr:["1","2","3"]})},close:function(){if(!this.ws)return this.appendMsg("错误提示","请先开启 socket 链接");this.ws.close()}}},e.default=c.default.createPage(e.default).getOptions()},189:function(t,e,s){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.default.initSocket(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;var o=s(190),i=function(t){return t&&t.__esModule?t:{default:t}}(o)},190:function(t,e,s){(0,s(1).copyProtoProperty)(e.default)}},[186]);